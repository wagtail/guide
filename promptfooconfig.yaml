# yaml-language-server: $schema=https://promptfoo.dev/config-schema.json
prompts:
  #- file://prompts/support-with-nothing.txt
  #- file://prompts/support-with-instructions.txt
  #- file://prompts/support-with-llms.txt
  - file://prompts/support-with-llms-abridged.txt
  - file://prompts/support-with-llms-full.txt
providers:
  # - id: openrouter:mistralai/ministral-14b-2512
  #   config:
  #     apiKey: process.env.OPENROUTER_API_KEY
  # - id: openai:chat:liquid/lfm2-1.2b
  #   config:
  #     apiBaseUrl: http://127.0.0.1:1234/v1
  #     apiKey: not-needed
  - id: openai:chat:mistralai/ministral-3-3b
    config:
      apiBaseUrl: http://127.0.0.1:1234/v1
      apiKey: not-needed
  - id: openai:chat:mistral-small-3.2-24b-instruct-2506
    config:
      apiBaseUrl: 'https://api.scaleway.ai/{{ env.SCW_DEFAULT_PROJECT_ID }}/v1'
      apiKey: '{{ env.SCW_SECRET_KEY }}'
  - id: openai:chat:gpt-oss-120b
    config:
      apiBaseUrl: 'https://api.scaleway.ai/{{ env.SCW_DEFAULT_PROJECT_ID }}/v1'
      apiKey: '{{ env.SCW_SECRET_KEY }}'
  - id: anthropic:messages:claude-opus-4-5-20251101
defaultTest:
  options:
    temperature: 0.7
  vars:
    llms_txt: file://prompts/llms.txt
    llms_full: file://prompts/llms-full.txt
    llms_abridged: file://prompts/llms-abridged.txt
  assert:
    - type: llm-rubric
      value: The response should provide a step-by-step guide or a clear summary.
    - type: icontains
      value: guide.wagtail.org
    - type: not-regex
      value: \/editor_manual|\.html
tests:
  - description: Well-known feature - new page
    vars:
      user_message: How do I create a new page?
    assert:
      - type: icontains-all
        value:
          - add
          - child page
          - page type
          - save
          - manage pages
          - https://guide.wagtail.org/en-latest/how-to-guides/manage-pages/

  - description: Unsupported feature - document recovery
    vars:
      user_message: How do I recover a document I just deleted?
    assert:
      - type: icontains-all
        value:
          - https://guide.wagtail.org/en-latest/how-to-guides/manage-documents/
      - type: llm-rubric
        value: The response should be clear that document recovery isnâ€™t supported by default.

  - description: Well-known feature - snippets
    vars:
      user_message: What is a snippet in Wagtail?
    assert:
      - type: icontains-all
        value:
          - https://guide.wagtail.org/en-latest/how-to-guides/manage-snippets/
      - type: llm-rubric
        value: The response should explain that snippets are reusable content elements.

  - description: Common gotcha - image resizing
    vars:
      user_message: Does Wagtail support image resizing?
    assert:
      - type: icontains-all
        value:
          - focal
      - type: llm-rubric
        value: The response should be clear that image resizing within the CMS is about focal area management, not direct cropping support within the CMS.

  - description: Accurate retrieval - keyboard shortcuts
    vars:
      user_message: What are the keyboard shortcuts available in Wagtail?
    assert:
      - type: icontains-all
        value:
          - https://guide.wagtail.org/en-latest/concepts/accessibility-features/
          - rich text
          - '?'
          - '/'
